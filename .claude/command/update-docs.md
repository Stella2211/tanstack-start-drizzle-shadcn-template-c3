---
name: update-docs
description: 実装内容に合わせてドキュメントの更新を行います
color: green
---
# ドキュメント更新ガイドライン

このコマンドは、プロジェクトのドキュメントを更新する際のガイドラインです。これを遵守して、あなたが行ったコードの変更をドキュメントにも反映させてください。

## 📋 ドキュメント構造の原則

### 1. ドキュメントの配置ルール

**README.md（プロジェクトルート）**
- **目的**: プロジェクト概要とクイックスタート
- **内容**: 技術スタック、セットアップ手順、主要コマンド
- **文字数制限**: 200行以内を目標
- **含めないもの**: 変更履歴、詳細な実装手順、API仕様

**CLAUDE.md（AIアシスタント向け）**
- **目的**: AIアシスタントが作業する際の重要な注意事項
- **内容**: 重大なバグの回避方法、最重要の実装パターン、クイックリファレンス
- **文字数制限**: 400行以内を目標
- **含めないもの**: 完全なAPI仕様、データベーススキーマ全文、コーディング規約全文

**docs/（詳細ドキュメント）**
- **目的**: 完全な技術仕様とガイド
- **内容**: API仕様、データベーススキーマ、実装パターン、トラブルシューティング
- **文字数制限**: 1ファイル300行以内を目標
- **含めないもの**: 変更履歴、未来の実装計画

**各サービスのREADME.md**
- **目的**: サービス固有のセットアップとデプロイ手順
- **内容**: セットアップ、開発、デプロイ、主要コマンド、docs/へのリンク
- **文字数制限**: 200行以内を目標
- **含めないもの**: API仕様全文、実装パターン全文

### 2. ドキュメント間のリンク

ドキュメントは階層的に参照します：

```
README.md
  └→ docs/README.md（ドキュメント索引）
      ├→ docs/architecture/overview.md
      ├→ docs/api/endpoints.md
      └→ ...

CLAUDE.md
  └→ 重要な注意事項（最小限のコード例）
  └→ docs/へのリンク

backend/README.md
  └→ セットアップと概要
  └→ docs/へのリンク
```

### 3. コード例の扱い

**README.md / 各サービスのREADME.md**
- コマンド例のみ（セットアップ、開発、デプロイ）
- コード例は含めない

**CLAUDE.md**
- 最重要のコード例のみ
- 10-20行以内に収める
- ファイルパス参照を含める

**docs/**
- 完全なコード例を含めてOK
- ただし、ファイルパス参照を優先（実際のコードを読むことを推奨）

## 🔄 ドキュメント更新フロー

### 新機能追加時

1. **実装ファイルを更新**
   - コードに変更を加える

2. **docs/の該当ファイルを更新**
   - サーバー側 → `docs/server/`
   - クライアント側 → `docs/client/`
   - 共通部分 → `docs/common/`
   - トラブルシューティング項目 → `docs/troubleshooting/`

3. **必要に応じてREADME.mdやCLAUDE.mdを更新**
   - 重大な変更のみ
   - 詳細はdocs/へのリンクで対応

4. **docs/README.mdの索引を確認**
   - 新しいドキュメントを追加した場合は索引を更新

### 既存ドキュメントの更新

1. **docs/の該当ファイルを更新**
   - 詳細情報はすべてdocs/に

2. **README.mdやCLAUDE.mdは最小限の変更**
   - 概要レベルの変更のみ

## 🚫 やってはいけないこと

### 1. 変更履歴をドキュメントに含める
❌ 悪い例:
```markdown
## 変更履歴
- 2025-11-04: WebSocket実装を追加
- 2025-11-02: バックエンドをリファクタリング
```

✅ 良い例:
- Gitの履歴を使う

### 2. 未来の実装計画を含める
❌ 悪い例:
```markdown
## 今後の実装予定
- [ ] モバイル対応の改善
- [ ] チャット機能
```

✅ 良い例:
- GitHubのIssuesやProject boardを使う
- ドキュメントには現在の仕様のみを記載

### 3. コード全文を埋め込む
❌ 悪い例:
```markdown
## ユーザー追加関数
\`\`\`typescript
// 全文を埋め込む
\`\`\`
```

✅ 良い例:
```markdown
## ユーザー追加関数
**実装ファイル**: `backend/src/routes/cards/create-card.ts`

**主要な処理**:
1. Zodスキーマでバリデーション
2. Drizzle ORMでDB挿入
3. 画像を動的生成してレスポンス

詳細は実装ファイルを参照してください。
```

### 4. README.mdやCLAUDE.mdを肥大化させる
❌ 悪い例:
- README.mdに600行のAPI仕様を記載
- CLAUDE.mdに2000行の実装パターンを記載

✅ 良い例:
- README.mdは200行以内
- CLAUDE.mdは400行以内
- 詳細はdocs/へのリンクで対応

## 📁 ドキュメントファイルの配置

```
docs/
├── README.md                      # ドキュメント索引（すべてのドキュメントへのリンク）
├── common/
│   ├── overview.md                # システム構成、モノレポ管理
│   ├── client.md                  # 各サービスの詳細説明をそれぞれ別のmarkdownとして保存
│   ├── server.md
│   └── ...
├── server/
│   ├── overview.md                # 全体の構成
│   └── ...                        # 各機能の詳細ドキュメント
├── client/
│   ├── overview.md                # 全体の構成
│   └── ...                        # 各機能の詳細ドキュメント
├── database/
│   ├── schema.md                  # テーブル定義とER図
│   └── migrations.md              # マイグレーション手順
└── testing/
    └── philosophy.md              # テスト哲学とパターン
```

## ✅ チェックリスト

新しいドキュメントを作成・更新する際は、以下を確認してください：

- [ ] ファイルサイズは300行以内か？
- [ ] 変更履歴や未来の計画を含めていないか？
- [ ] コード例は最小限か？ファイルパス参照を使っているか？
- [ ] README.mdやCLAUDE.mdは簡潔に保たれているか？
- [ ] docs/README.mdの索引は更新されているか？
- [ ] 他のドキュメントへのリンクは正しいか？

## 🔗 関連リソース

- [docs/README.md](../docs/README.md) - ドキュメント索引
- [README.md](../README.md) - プロジェクト概要
- [CLAUDE.md](../CLAUDE.md) - AIアシスタント向けガイド